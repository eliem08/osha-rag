from langchain.document_loaders import WebBaseLoader, UnstructuredURLLoader
from langchain.embeddings import OpenAIEmbeddings
from langchain.vectorstores import FAISS
from langchain.text_splitter import RecursiveCharacterTextSplitter
from langchain.schema import Document

import os
import logging
import time
from dotenv import load_dotenv

load_dotenv()

# Configure logging
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# Ensure the OpenAI API key is set
api_key = os.getenv('OPENAI_API_KEY')
if not api_key:
    raise EnvironmentError("Please set the OPENAI_API_KEY environment variable.")

def scrape_and_index():
    # List of URLs to scrape
    urls = [
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910TableofContents',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.2',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.3',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.4',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.5',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.6',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.7',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.7AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.8',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.9',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.11',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.12',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.15',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.16',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.17',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.18',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.19',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.21',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.22',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.23',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.24',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.25',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.26',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.27',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.28',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.29',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.30',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.33',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.34',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.35',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.36',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.37',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.38',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.39',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartEApp',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartF',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.66',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.66AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.66AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.66AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.66AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.67',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.68',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartG',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.94',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.95',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.95AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.95AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.95AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.95AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.95AppE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.95AppF',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.95AppG',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.95AppH',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.95AppI',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.97',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.98',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartH',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.101',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.102',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.103',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.104',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.105',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.106',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.107',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.108',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.109',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.110',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.111',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.112',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.113',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.119',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.119AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.119AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.119AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.119AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.120',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.120AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.120AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.120AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.120AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.120AppE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.121',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.122',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.123',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.124',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.125',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.126',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartI',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.132',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.133',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.134',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.134AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.134AppB1',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.134AppB2',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.134AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.134AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.135',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.136',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.137',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.138',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.139',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.140',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartIAppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartIAppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartIAppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartIAppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartJ',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.141',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.142',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.143',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.144',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.145',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.145AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.145AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.146',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.146AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.146AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.146AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.146AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.146AppE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.146AppF',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.147',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.147AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartK',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.151',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.151AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.152',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartL',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.155',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.156',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.157',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.158',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.159',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.160',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.161',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.162',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.163',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.164',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.165',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartLAppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartLAppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartLAppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartLAppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartLAppE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartM',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.166',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.167',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.168',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.169',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartN',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.176',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.177',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.177AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.177AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.178',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.178AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.179',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.180',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.181',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.183',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.184',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartO',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.211',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.212',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.213',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.214',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.215',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.216',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.217',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.217AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.217AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.217AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.217AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.218',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.219',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartP',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.241',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.242',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.243',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.244',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartQ',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.251',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.252',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.253',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.254',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.255',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartR',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.261',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.262',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.263',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.264',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.265',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.266',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.266AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.266AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.266AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.268',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.269',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.269AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.269AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.269AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.269AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.269AppE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.269AppF',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.269AppG',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.272',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.272AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.272AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.272AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartS',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.301',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.302',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.303',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.304',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.305',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.306',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.307',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.308',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.309',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.310',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.311',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.312',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.313',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.314',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.315',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.316',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.317',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.318',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.319',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.320',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.321',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.322',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.323',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.324',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.325',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.326',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.327',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.328',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.329',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.330',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.331',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.332',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.333',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.334',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.335',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.336',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.337',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.338',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.339',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.340',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.341',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.342',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.343',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.344',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.345',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.346',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.347',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.348',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.349',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.350',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.351',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.352',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.353',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.354',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.355',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.356',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.357',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.358',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.359',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.360',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.361',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.362',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.363',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.364',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.365',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.366',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.367',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.368',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.369',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.370',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.371',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.372',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.373',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.374',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.375',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.376',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.377',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.378',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.379',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.380',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.381',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.382',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.383',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.384',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.385',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.386',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.387',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.388',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.389',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.390',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.391',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.392',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.393',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.394',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.395',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.396',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.397',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.398',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.399',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartSAppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartT',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.401',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.402',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.410',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.420',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.421',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.422',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.423',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.424',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.425',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.426',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.427',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.430',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.440',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartTAppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartTAppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartTAppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartU',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.501',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.502',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.504',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.505',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.509',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartV',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartW',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartX',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartY',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910SubpartZ',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1000',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1000TABLEZ1',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1000TABLEZ2',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1000TABLEZ3',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001AppE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001AppF',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001AppG',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001AppH',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001AppI',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1001AppJ',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1002',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1003',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1004',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1005',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1006',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1007',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1008',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1009',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1010',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1011',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1012',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1013',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1014',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1015',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1016',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1017',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1017AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1018',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1018AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1018AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1018AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1020',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1020AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1020AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1024',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1024AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1025',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1025AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1025AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1025AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1026',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1026AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1027',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1027AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1027AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1027AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1027AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1027AppE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1027AppF',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1028',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1028AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1028AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1028AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1028AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1029',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1029AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1029AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1030',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1030AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1043',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1043AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1043AppBI',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1043AppBII',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1043AppBIII',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1043AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1043AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1044',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1044AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1044AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1044AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1045',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1045AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1045AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1045AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1045AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1047',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1047AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1047AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1047AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1047AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1048',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1048AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1048AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1048AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1048AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1048AppE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1050',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1050AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1050AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1050AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1050AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1051',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1051AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1051AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1051AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1051AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1051AppE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1051AppF',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1052',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1052AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1052AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1052AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1053',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1053AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1053AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1096',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1200',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1200AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1200AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1200AppC',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1200AppD',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1200AppE',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1200AppF',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1201',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1450',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1450AppA',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1450AppB',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1451',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1452',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1453',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1454',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1455',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1456',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1457',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1458',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1459',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1460',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1461',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1462',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1463',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1464',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1465',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1466',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1467',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1468',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1469',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1470',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1471',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1472',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1473',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1474',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1475',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1476',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1477',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1478',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1479',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1480',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1481',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1482',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1483',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1484',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1485',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1486',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1487',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1488',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1489',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1490',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1491',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1492',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1493',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1494',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1495',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1496',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1497',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1498',
            'https://www.osha.gov/laws-regs/regulations/standardnumber/1910/1910.1499'
        ]

    # Initialize lists to keep track of successes and failures
    successful_docs = []
    failed_urls = []

    # Optional: Set maximum retries and delay between retries
    max_retries = 3
    retry_delay = 5  # seconds

    # Iterate over URLs and load them individually
    for url in urls:
        success = False
        for attempt in range(1, max_retries + 1):
            try:
                # You can use WebBaseLoader or UnstructuredURLLoader
                loader = WebBaseLoader([url])
                # loader = UnstructuredURLLoader(urls=[url])  # Alternative loader

                documents = loader.load()
                if documents:
                    # Assuming each URL returns one document
                    doc = documents[0]
                    successful_docs.append(doc)
                    logger.info(f"Successfully loaded {url}")
                    success = True
                    break  # Exit retry loop on success
                else:
                    logger.warning(f"No content found at {url}")
                    break  # No point in retrying if content is empty
            except Exception as e:
                logger.error(f"Attempt {attempt} - Failed to load {url}: {e}")
                if attempt < max_retries:
                    logger.info(f"Retrying {url} in {retry_delay} seconds...")
                    time.sleep(retry_delay)
                else:
                    logger.error(f"All retries failed for {url}")
        if not success:
            failed_urls.append(url)

    # Report failed URLs
    if failed_urls:
        logger.warning("The following URLs failed to load:")
        for url in failed_urls:
            logger.warning(url)
    else:
        logger.info("All URLs loaded successfully.")

    # Check if any documents were loaded successfully
    if not successful_docs:
        logger.error("No documents were loaded. Exiting.")
        return

    # Step 2: Process Documents
    text_splitter = RecursiveCharacterTextSplitter(chunk_size=1000, chunk_overlap=200)
    split_docs = []
    for doc in successful_docs:
        splits = text_splitter.split_text(doc.page_content)
        for idx, chunk in enumerate(splits):
            # Add URL and paragraph number to metadata
            metadata = doc.metadata.copy()
            # Ensure the 'source' key contains the URL
            metadata['url'] = metadata.get('source', 'unknown')
            if metadata['url'] == 'unknown':
                metadata['url'] = doc.metadata.get('url', 'unknown')
            if metadata['url'] == 'unknown':
                metadata['url'] = url  # Fallback to the current URL

            metadata['paragraph'] = idx + 1  # Paragraph number
            split_docs.append(Document(page_content=chunk, metadata=metadata))

    # Check if there are any split documents
    if not split_docs:
        logger.error("No content to index after splitting. Exiting.")
        return

    # Step 3: Create FAISS Index
    embeddings = OpenAIEmbeddings()
    faiss_index = FAISS.from_documents(split_docs, embeddings)

    # Step 4: Save FAISS Index
    faiss_index.save_local("faiss_index")
    logger.info("FAISS index created and saved successfully.")

if __name__ == '__main__':
    scrape_and_index()
